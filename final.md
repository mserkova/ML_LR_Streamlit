# Выводы по работе


### Этап 1: Предобработка данных
- Заполнены пропуски медианными значениями (`df_train` и `df_test`), рассчитанными по `df_train`
- Очищены числовые признаки (`mileage`, `engine`, `max_power`) от единиц измерения (`kmpl`, `CC`, `bhp`) и преобразованы в числовой формат.
- Удалён столбец `torque`из-за сложности его обработки (на данном этапе у меня есть только предположения, как его обработать).
- Удалены частичные дубликаты (строки с одинаковыми признаками, но разной ценой)
- Приведены типы: `engine` и `seats` переведены в `int64`
- Посчитаны основные статистики по числовым и категориальным столбцам

### Этап 2: Визуализация данных (EDA)
- Построен `pairplot` для числовых признаков — выявлена связь между признаками и целевой переменной.
- Построена heatmap корреляций Пирсона:
  - Сильная положительная корреляция: `engine` и `max_power` (0.68), `selling_price` и `max_power` (0.69).
  - Отрицательная корреляция: `year` и `km_driven` (-0.37).
  - Слабая связь: `seats` и `mileage`.

### Этап 3: Обучение и сравнение моделей
- Обучены модели: `LinearRegression`, `Lasso`, `Ridge`, `ElasticNet`- со стандартизированными данными
- Подбор гиперпараметров с помощью `GridSearchCV` (10-кратная кросс-валидация):
  - Перебор `alpha` ∈ `[0.01, 0.1, 1.0, 10.0, 100.0]`.
  - Для `ElasticNet` дополнительно перебор `l1_ratio` ∈ `[0.1, 0.5, 0.9]`.
- Рассчитаны метрики: `R²` (чем ближе к 1, тем лучше), `MSE`, и бизнес-метрика:
  `Lasso`: R² на train: 0.5922629595497046
         R² на test: 0.5941429546560312
         MSE на train: 116873067761.63504
         MSE на test: 233298219170.76022
  Результаты идентичные, как и на обучении модели без регуляризации. За счет подбора критерия alpha было выявлено, что при alpha = 1.0 регуляризация слабая коэффициенты не зануляются.
  `ElasticNet`: Лучшие параметры: {'alpha': 1.0, 'l1_ratio': 0.9} - были подобраны при помощи GridSearchCV
                Лучший R² (средний по фолдам): 0.5761378555173832
                Также стоит отметить, что у `ElasticNet` бизнес-метрика была лучшая, поэтому в основе приложения Streamlit лежит именно эта модель

  `Ridge`: R² (средний по фолдам): 0.5762362434626459
           Лучшие параметры: {'alpha': 1000.0}
В целом результаты обучения можно считать удовлетворительными, однако по ходу выполнения работы мне не удалось улучшить качество.
Ожидалось, что регуляризация `ElasticNet`, добавление категориальных признаков методом OHE, подбор гиперпараметров с помощью `GridSearchCV` дадут прирост в качестве модели...
На мой взгляд, можно бы было рассмотреть обработку столбца `torque`, `name`, не удаляя их. Также хотелось бы подробнее изучить распределения функций, возможно бы логарифмирование пригодилось.


### Этап 4: Создание Streamlit-приложения
- Сохранена лучшая модель в `model.pkl`.
- Разработано интерактивное приложение с вкладками:
  - EDA (графики, фильтры),
  - Визуализация весов модели `ElasticNet`,
  - Предсказание стоимости.

- Приложение получилось простым и удобным в использовании
- Представлены основные визуализации, были выбраны самые информативные
- Ограничения: первый опыт работы со Streamlit, трудности с созданием `pickle`
- Улучшения: для графиков можно было бы улучшить интерактивность (на официальном сайте представлены безграничные возможности в визуализации), использовать более сложные инструменты (например, фильтрация)


